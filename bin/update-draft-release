#!/usr/bin/env ruby
# encoding: utf-8

require 'update_draft_release'

if ARGV.empty? || ARGV[0].empty?
  puts 'Missing: repository name'
  exit
end

repo = 'why_you_no_repo'
options = {}

# Acceptable options:
#
# --in-gamma
# --in-assignment
# --in-top-level
# --at-the-end
# --create-heading
# --open-url
# --skip-confirmation
#
ARGV.each do |arg|
  case arg
  when /^--in-(\w+)$/
    options[:insert_into] = $1.gsub('_', ' ')
  when '--in-top-level'
    options[:insert_into] = 'top-level'
  when '--at-the-end'
    options[:insert_at_the_end] = true
  when '--create-heading'
    options[:create_heading] = true
  when '--open-url'
    options[:open_url_after_update] = true
  when '--skip-confirmation'
    options[:skip_confirmation] = true
  when /--([-\w]+)/
    puts "Invalid option: --#{$1}"
    exit
  else
    repo = arg
  end
end

runner = UpdateDraftRelease::Runner.new(repo, options)
runner.update_draft_release
